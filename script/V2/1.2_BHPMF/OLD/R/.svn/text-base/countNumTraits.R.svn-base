countNumTraits <- function(X, flagNan){

    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    #find number of traits for each observation
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    numRows = nrow(X);
    numCols = ncol(X);
    noTraits = rep(0, times = numRows);
    
    traitIds = vector('list', numRows);

    for (plantId in 1 : numRows){
        if(flagNan){
			traitId = which(!is.na(X[plantId, ]));
		}
		else{
			traitId = which(X[plantId, ] != 0);
		}
		
        traitIds[[plantId]] = traitId;
        noTraits[plantId] = length(traitId);
    }

    cc = hist(noTraits, max(noTraits), xlab = " Number of available traits for each observation", main = "", axes=F)
	axis(2)
	axis(1, at=seq(0, numCols, 1))

    print(cc)

    indObs = which(noTraits > 0);

    return(list(noTraits ,indObs ,traitIds))
    
}
